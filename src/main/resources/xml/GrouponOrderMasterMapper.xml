<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zsl.upmall.mapper.GrouponOrderMasterDao">

	<resultMap id="BaseResultMap" type="com.zsl.upmall.entity.GrouponOrderMaster">
		<id column="id" property="id" />
		<id column="groupon_order_id" property="grouponOrderId" />
		<id column="order_id" property="orderId" />
		<id column="member_id" property="memberId" />
		<id column="voucher" property="voucher" />
		<id column="win_voucher" property="winVoucher" />
		<id column="groupon_result" property="grouponResult" />
		<id column="back_prize" property="backPrize" />
		<id column="groupon_status" property="grouponStatus" />
	</resultMap>
	<sql id="Base_Column_List">
		id, groupon_order_id, order_id, member_id, voucher, win_voucher,groupon_result, back_prize, groupon_status
	</sql>


	<resultMap id="GrouponListMap" type="com.zsl.upmall.vo.out.GrouponListVo">
		<result column="grouponName" property="grouponName" jdbcType="VARCHAR" />
		<result column="nickName" property="nickName" jdbcType="VARCHAR"/>
		<result column="payTime" property="payTime" jdbcType="DATE"/>
		<result column="goodsCount" property="goodsCount" jdbcType="INTEGER"/>
	</resultMap>


	<select id="getGrouponListByPage" resultMap="GrouponListMap">
		SELECT
			ga.activity_title grouponName,
			u.nick_name nickName,
			o.pay_time payTime,
			d.goods_count goodsCount
		FROM
			`groupon_order_master` g
		LEFT JOIN user_member u on u.id = g.member_id
		LEFT JOIN order_master o on o.id = g.order_id
		LEFT JOIN order_detail d on d.order_id = g.order_id
		LEFT JOIN groupon_order go on go.id = g.groupon_order_id
		LEFT JOIN groupon_activities ga on ga.id = go.groupon_activities_id
		WHERE
			g.groupon_order_id = #{grouponOrderId}
	</select>

</mapper>